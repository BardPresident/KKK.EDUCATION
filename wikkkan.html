<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ WIKKKAN ğŸ‘‘</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap');

        [data-theme="dark"] {
            --gold:#ffd700; --gold-mid:#f0c830; --gold-dim:#d4a820;
            --gold-muted:#c49020; --gold-soft:#b08018;
            --gold-glow:rgba(255,215,0,0.2);
            --bg:#05020e; --bg-header:rgba(8,4,18,0.95);
            --bg-msg:rgba(255,215,0,0.065); --bg-msg-hover:rgba(255,215,0,0.1);
            --bg-user:rgba(255,255,255,0.06); --bg-input:rgba(10,6,22,0.8);
            --bg-footer:rgba(8,4,18,0.9); --bg-save:rgba(212,175,55,0.1);
            --bg-save-h:rgba(212,175,55,0.2);
            --text:#f5e8c0; --text-user:#e0d0a8; --text-ui:#d4a820;
            --text-hint:#b08018; --text-time:#9a7015; --text-dim:#7a5812;
            --border:rgba(212,175,55,0.25); --border-strong:rgba(212,175,55,0.45);
            --border-input:rgba(212,175,55,0.3); --border-focus:rgba(255,215,0,0.7);
            --placeholder:rgba(212,175,55,0.35);
            --btn-bg:rgba(212,175,55,0.1); --btn-text:#d4a820;
            --btn-hover-bg:rgba(212,175,55,0.2); --btn-hover-text:#ffd700;
            --btn-discuss:rgba(212,175,55,0.14); --btn-discuss-h:rgba(212,175,55,0.28);
            --dot:#d4a820;
            --ambient1:rgba(100,20,190,0.12); --ambient2:rgba(190,110,10,0.08);
            --ambient3:rgba(20,80,180,0.06);
            --copy-bg:rgba(8,4,18,0.95); --scrollbar:rgba(212,175,55,0.2);
            --shadow:rgba(0,0,0,0.6);
            --danger-text:#e88080; --danger-bg:rgba(200,60,60,0.15);
            --danger-hover:rgba(200,60,60,0.28); --danger-border:rgba(200,80,80,0.45);
            --sources-text:#c49020;
        }

        [data-theme="light"] {
            --gold:#6a4000; --gold-mid:#8a5800; --gold-dim:#5a3400;
            --gold-muted:#7a4e00; --gold-soft:#6a4200;
            --gold-glow:rgba(106,64,0,0.12);
            --bg:#fdf8ef; --bg-header:rgba(253,248,239,0.95);
            --bg-msg:rgba(139,90,0,0.065); --bg-msg-hover:rgba(139,90,0,0.1);
            --bg-user:rgba(0,0,0,0.042); --bg-input:rgba(255,252,245,0.95);
            --bg-footer:rgba(245,235,210,0.98); --bg-save:rgba(139,90,0,0.12);
            --bg-save-h:rgba(139,90,0,0.22);
            --text:#1e1000; --text-user:#2e1800; --text-ui:#6a4000;
            --text-hint:#7a4e00; --text-time:#8a5800; --text-dim:#9a6808;
            --border:rgba(139,90,0,0.22); --border-strong:rgba(139,90,0,0.42);
            --border-input:rgba(139,90,0,0.32); --border-focus:rgba(139,90,0,0.65);
            --placeholder:rgba(139,90,0,0.32);
            --btn-bg:rgba(139,90,0,0.09); --btn-text:#6a4000;
            --btn-hover-bg:rgba(139,90,0,0.18); --btn-hover-text:#4a2800;
            --btn-discuss:rgba(139,90,0,0.11); --btn-discuss-h:rgba(139,90,0,0.22);
            --dot:#8a5800;
            --ambient1:rgba(180,130,30,0.08); --ambient2:rgba(130,80,10,0.06);
            --ambient3:rgba(20,80,160,0.04);
            --copy-bg:rgba(253,248,239,0.97); --scrollbar:rgba(139,90,0,0.18);
            --shadow:rgba(0,0,0,0.1);
            --danger-text:#c03030; --danger-bg:rgba(180,40,40,0.1);
            --danger-hover:rgba(180,40,40,0.2); --danger-border:rgba(180,40,40,0.4);
            --sources-text:#7a4e00;
        }

        :root { --chat-size: 0.88em; }

        * { margin:0; padding:0; box-sizing:border-box; }
        html, body { height:100%; overflow:hidden; }

        body {
            background:var(--bg); color:var(--text);
            font-family:'Crimson Text',serif;
            display:flex; flex-direction:column;
            transition:background 0.35s, color 0.35s;
        }

        body::before {
            content:''; position:fixed; inset:0;
            background:
                radial-gradient(ellipse 80% 55% at 10% 75%,var(--ambient1) 0%,transparent 52%),
                radial-gradient(ellipse 55% 45% at 88% 20%,var(--ambient2) 0%,transparent 50%),
                radial-gradient(ellipse 40% 35% at 50% 100%,var(--ambient3) 0%,transparent 45%);
            pointer-events:none; z-index:0; transition:background 0.35s;
        }

        /* â”€â”€ FULLSCREEN MODE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        body.fullscreen header,
        body.fullscreen footer { display:none !important; }
        body.fullscreen main { max-width:100%; padding:0 10px; }
        body.fullscreen .fullscreen-exit { display:flex !important; }

        .fullscreen-exit {
            display:none;
            position:fixed; bottom:68px; right:10px; z-index:50;
        }

        .fullscreen-exit .hbtn {
            opacity:0.9;
            box-shadow:0 2px 12px var(--shadow);
        }

        /* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        header {
            position:relative; z-index:20; text-align:center;
            padding:14px 110px 10px;
            border-bottom:1px solid var(--border);
            background:var(--bg-header);
            backdrop-filter:blur(12px); flex-shrink:0;
            transition:background 0.35s, border-color 0.35s;
        }

        header h1 {
            font-family:'Cinzel',serif; font-size:1.7em; font-weight:900;
            letter-spacing:0.42em; color:var(--gold);
            text-shadow:0 0 50px var(--gold-glow),0 0 20px var(--gold-glow);
        }

        header .tagline {
            margin-top:3px; font-size:0.68em; color:var(--gold-muted);
            letter-spacing:0.18em; font-style:italic;
        }

        .header-left {
            position:absolute; top:14px; left:10px;
            display:flex; gap:5px; align-items:center; flex-wrap:wrap;
            max-width:105px;
        }

        .header-controls {
            position:absolute; top:14px; right:10px;
            display:flex; gap:5px; align-items:center; flex-wrap:wrap;
            max-width:110px; justify-content:flex-end;
        }

        .hbtn {
            background:var(--btn-bg); border:1px solid var(--border-strong);
            color:var(--btn-text); font-family:'Cinzel',serif;
            font-size:0.6em; font-weight:700; letter-spacing:0.08em;
            padding:5px 10px; border-radius:999px; cursor:pointer;
            transition:all 0.2s; display:flex; align-items:center; gap:3px;
            white-space:nowrap;
        }

        .hbtn:hover { background:var(--btn-hover-bg); color:var(--btn-hover-text); }

        .hbtn.danger {
            color:var(--danger-text); background:var(--danger-bg);
            border-color:var(--danger-border);
        }

        .hbtn.danger:hover { background:var(--danger-hover); }

        /* Font size buttons */
        .size-btns {
            display:flex; gap:3px; align-items:center;
        }

        .size-btn {
            background:var(--btn-bg); border:1px solid var(--border-strong);
            color:var(--btn-text); font-family:'Cinzel',serif;
            font-size:0.7em; font-weight:900;
            width:26px; height:26px;
            border-radius:50%; cursor:pointer;
            display:flex; align-items:center; justify-content:center;
            transition:all 0.2s; flex-shrink:0;
        }

        .size-btn:hover { background:var(--btn-hover-bg); color:var(--btn-hover-text); }

        nav {
            margin-top:8px; display:flex; justify-content:center;
            gap:5px; flex-wrap:wrap;
        }

        nav a {
            padding:3px 11px; border:1px solid var(--border-strong);
            border-radius:999px; color:var(--btn-text); text-decoration:none;
            font-family:'Cinzel',serif; font-size:0.6em; font-weight:700;
            letter-spacing:0.09em; transition:all 0.2s;
        }

        nav a:hover { background:var(--btn-hover-bg); color:var(--btn-hover-text); }

        /* â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        main {
            position:relative; z-index:10; flex:1;
            display:flex; flex-direction:column;
            max-width:920px; width:100%;
            margin:0 auto; padding:0 14px; min-height:0;
        }

        /* â”€â”€ MESSAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #messages {
            flex:1; overflow-y:auto;
            padding:12px 0 6px;
            display:flex; flex-direction:column;
            gap:10px; scroll-behavior:smooth;
        }

        #messages::-webkit-scrollbar { width:3px; }
        #messages::-webkit-scrollbar-track { background:transparent; }
        #messages::-webkit-scrollbar-thumb { background:var(--scrollbar); border-radius:2px; }

        .msg { display:flex; gap:8px; animation:fadeUp 0.25s cubic-bezier(0.2,0,0.2,1); }

        @keyframes fadeUp {
            from { opacity:0; transform:translateY(6px); }
            to   { opacity:1; transform:translateY(0); }
        }

        .msg.user { flex-direction:row-reverse; }

        .avatar {
            width:28px; height:28px; border-radius:50%;
            display:flex; align-items:center; justify-content:center;
            font-size:0.85em; flex-shrink:0;
            border:1px solid var(--border-strong);
            background:var(--bg-msg); margin-top:2px;
        }

        .bubble-wrap {
            max-width:82%; display:flex;
            flex-direction:column; gap:3px;
        }

        .msg.user .bubble-wrap { align-items:flex-end; }

        .bubble {
            padding:10px 14px;
            line-height:1.85; font-size:var(--chat-size);
            position:relative;
            transition:background 0.35s, border-color 0.35s;
        }

        .msg.wikkkan .bubble {
            background:var(--bg-msg); border:1px solid var(--border);
            border-radius:3px 14px 14px 14px; color:var(--text);
        }

        .msg.wikkkan .bubble:hover { background:var(--bg-msg-hover); }

        .msg.user .bubble {
            background:var(--bg-user); border:1px solid var(--border);
            border-radius:14px 3px 14px 14px; color:var(--text-user);
        }

        /* â”€â”€ COPY BUTTON â€” desktop hover / mobile below â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .copy-btn {
            font-family:'Cinzel',serif; font-size:0.58em; font-weight:700;
            letter-spacing:0.06em; cursor:pointer;
            color:var(--btn-text); background:var(--copy-bg);
            border:1px solid var(--border-strong);
            padding:2px 9px; border-radius:4px;
            transition:opacity 0.16s, color 0.16s;
            user-select:none; -webkit-user-select:none;
            backdrop-filter:blur(6px);
        }

        /* Desktop: float inside bubble, hidden until hover */
        @media (hover:hover) and (pointer:fine) {
            .copy-btn {
                position:absolute; top:6px; right:7px; opacity:0;
            }
            .msg.wikkkan .bubble:hover .copy-btn { opacity:1; }
        }

        /* Touch/mobile: show below bubble as a small pill */
        @media (hover:none), (pointer:coarse) {
            .copy-btn {
                position:static; display:inline-block;
                margin-top:5px; opacity:0.85;
                align-self:flex-start;
            }
            /* Put it in bubble-wrap after bubble, not inside bubble */
            .mobile-copy-wrap {
                display:flex;
            }
        }

        .copy-btn:hover { color:var(--gold); }

        /* Timestamp */
        .msg-time {
            font-size:0.63em; color:var(--text-time);
            font-family:'Cinzel',serif; font-weight:700;
            letter-spacing:0.05em; padding:0 3px;
        }

        .msg.user .msg-time { text-align:right; }

        /* Sources */
        .sources {
            font-size:0.68em; color:var(--sources-text);
            font-style:normal; font-weight:600;
            line-height:1.7; padding:1px 3px;
        }

        .sources a {
            color:var(--sources-text); text-decoration:none;
            border-bottom:1px solid var(--sources-text); padding-bottom:1px;
            transition:color 0.16s, border-color 0.16s;
        }

        .sources a:hover { color:var(--gold); border-color:var(--gold); }

        /* Day dividers */
        .day-divider {
            display:flex; align-items:center;
            gap:10px; margin:4px 0 2px; opacity:0.6;
        }

        .day-divider span {
            font-family:'Cinzel',serif; font-size:0.6em; font-weight:700;
            color:var(--text-ui); letter-spacing:0.14em; white-space:nowrap;
        }

        .day-divider::before, .day-divider::after {
            content:''; flex:1; height:1px; background:var(--border-strong);
        }

        /* Thinking */
        .dots { display:flex; gap:5px; align-items:center; padding:3px 0; }
        .dots span {
            width:5px; height:5px; background:var(--dot);
            border-radius:50%; animation:bounce 1.25s infinite; opacity:0.5;
        }
        .dots span:nth-child(2) { animation-delay:0.18s; }
        .dots span:nth-child(3) { animation-delay:0.36s; }

        @keyframes bounce {
            0%,60%,100% { transform:translateY(0); opacity:0.35; }
            30%          { transform:translateY(-5px); opacity:1; }
        }

        .thinking-label {
            font-size:0.72em; font-weight:700;
            color:var(--text-ui); font-style:italic; margin-top:4px;
        }

        .cursor {
            display:inline-block; width:2px; height:0.82em;
            background:var(--gold-dim); margin-left:2px;
            vertical-align:text-bottom; animation:blink 0.72s infinite;
        }

        @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }

        /* â”€â”€ INPUT AREA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .input-area {
            flex-shrink:0; padding:8px 0 10px;
            border-top:1px solid var(--border-strong);
        }

        .input-meta {
            display:flex; align-items:center;
            justify-content:space-between; margin-bottom:6px; gap:8px;
        }

        .web-toggle {
            display:flex; align-items:center; gap:6px;
            font-size:0.82em; font-weight:700; color:var(--text-ui);
            cursor:pointer; user-select:none; transition:color 0.2s;
            padding:4px 9px; border:1px solid var(--border);
            border-radius:6px; background:var(--btn-bg);
        }

        .web-toggle:hover { color:var(--gold); border-color:var(--border-strong); }
        .web-toggle input { accent-color:var(--gold-mid); cursor:pointer; width:14px; height:14px; }
        .web-toggle.active { color:var(--gold); border-color:var(--gold-dim); background:var(--btn-discuss); }

        .char-count { font-size:0.7em; font-weight:700; color:var(--text-hint); font-family:'Cinzel',serif; }
        .char-count.warn { color:#e09040; }

        .input-row { display:flex; gap:7px; align-items:flex-end; }

        #msgInput {
            flex:1; background:var(--bg-input);
            border:1px solid var(--border-input); color:var(--text);
            font-family:'Crimson Text',serif; font-size:1em; line-height:1.5;
            padding:9px 12px; border-radius:9px;
            outline:none; resize:none;
            min-height:40px; max-height:150px;
            transition:border-color 0.22s, box-shadow 0.22s, background 0.35s;
        }

        #msgInput::placeholder { color:var(--placeholder); }
        #msgInput:focus { border-color:var(--border-focus); box-shadow:0 0 0 3px var(--gold-glow); }

        #discussBtn {
            padding:9px 18px; background:var(--btn-discuss);
            border:1px solid var(--border-strong); color:var(--gold);
            font-family:'Cinzel',serif; font-size:0.84em; font-weight:700;
            letter-spacing:0.12em; cursor:pointer; border-radius:9px;
            transition:all 0.2s; white-space:nowrap;
            display:flex; align-items:center; gap:5px;
        }

        #discussBtn:hover:not(:disabled) {
            background:var(--btn-discuss-h); border-color:var(--gold);
            transform:translateY(-1px); box-shadow:0 4px 16px rgba(212,175,55,0.15);
        }

        #discussBtn:active:not(:disabled) { transform:translateY(0); box-shadow:none; }
        #discussBtn:disabled { opacity:0.22; cursor:not-allowed; transform:none !important; }

        .shortcut-hint {
            text-align:right; margin-top:4px;
            font-size:0.68em; font-weight:700; color:var(--text-hint);
            font-family:'Cinzel',serif; letter-spacing:0.05em;
        }

        /* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        footer {
            flex-shrink:0; border-top:2px solid var(--border-strong);
            background:var(--bg-footer); transition:all 0.35s;
        }

        .save-strip {
            padding:8px 14px;
            display:flex; align-items:center;
            justify-content:center; gap:8px; flex-wrap:wrap;
            border-bottom:1px solid var(--border);
        }

        .save-strip p {
            font-family:'Cinzel',serif; font-size:0.62em; font-weight:700;
            color:var(--text-ui); letter-spacing:0.07em;
            text-align:center; width:100%;
        }

        .save-btn {
            display:flex; align-items:center; gap:5px;
            padding:6px 14px; background:var(--bg-save);
            border:1px solid var(--border-strong); border-radius:6px;
            color:var(--gold); font-family:'Cinzel',serif;
            font-size:0.66em; font-weight:700; letter-spacing:0.09em;
            cursor:pointer; transition:all 0.2s; white-space:nowrap;
        }

        .save-btn:hover {
            background:var(--bg-save-h); border-color:var(--gold);
            transform:translateY(-1px); box-shadow:0 3px 12px rgba(212,175,55,0.15);
        }

        .save-btn:active { transform:translateY(0); box-shadow:none; }

        /* Android APK button â€” green accent */
        [data-theme="dark"] .save-btn.apk {
            color:#00e87a; border-color:rgba(0,232,122,0.45);
            background:rgba(0,180,80,0.1);
        }

        [data-theme="dark"] .save-btn.apk:hover {
            background:rgba(0,180,80,0.2); border-color:#00e87a;
        }

        [data-theme="light"] .save-btn.apk {
            color:#1a6b00; border-color:rgba(30,120,0,0.45);
            background:rgba(30,120,0,0.1);
        }

        [data-theme="light"] .save-btn.apk:hover {
            background:rgba(30,120,0,0.2); border-color:#1a6b00;
        }

        #saveStatus { font-size:0.66em; font-weight:700; color:var(--text-ui); font-family:'Cinzel',serif; }

        .util-strip {
            padding:5px 14px; display:flex; align-items:center;
            justify-content:space-between; gap:6px; flex-wrap:wrap;
        }

        .msg-counter { font-size:0.6em; font-weight:700; color:var(--text-hint); font-family:'Cinzel',serif; }

        /* â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #toast {
            position:fixed; bottom:70px; left:50%;
            transform:translateX(-50%) translateY(10px);
            background:var(--copy-bg); border:1px solid var(--border-strong);
            color:var(--gold-mid); font-family:'Cinzel',serif;
            font-size:0.72em; font-weight:700; letter-spacing:0.1em;
            padding:8px 20px; border-radius:999px;
            backdrop-filter:blur(8px); opacity:0; transition:all 0.25s;
            pointer-events:none; z-index:300; white-space:nowrap;
            box-shadow:0 4px 20px var(--shadow);
        }

        #toast.show { opacity:1; transform:translateX(-50%) translateY(0); }

        /* â”€â”€ CONFIRM DIALOG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #confirmOverlay {
            position:fixed; inset:0; background:rgba(0,0,0,0.6);
            backdrop-filter:blur(4px); z-index:200;
            display:flex; align-items:center; justify-content:center;
            opacity:0; pointer-events:none; transition:opacity 0.2s;
        }

        #confirmOverlay.show { opacity:1; pointer-events:all; }

        .confirm-box {
            background:var(--bg-header); border:1px solid var(--border-strong);
            border-radius:14px; padding:28px 30px;
            text-align:center; max-width:320px; width:88%;
            box-shadow:0 20px 60px var(--shadow);
        }

        .confirm-box p { font-family:'Cinzel',serif; font-size:1em; font-weight:900; color:var(--gold); letter-spacing:0.08em; margin-bottom:8px; }
        .confirm-box small { font-size:0.84em; color:var(--text-ui); font-style:italic; }

        .confirm-btns { display:flex; gap:10px; justify-content:center; margin-top:20px; }

        .confirm-btns button {
            padding:7px 22px; font-family:'Cinzel',serif;
            font-size:0.76em; font-weight:700; letter-spacing:0.1em;
            border-radius:7px; cursor:pointer; transition:all 0.18s; border:1px solid;
        }

        .cbtn-cancel { background:var(--btn-bg); border-color:var(--border-strong); color:var(--btn-text); }
        .cbtn-cancel:hover { background:var(--btn-hover-bg); color:var(--btn-hover-text); }
        .cbtn-confirm { background:var(--danger-bg); border-color:var(--danger-border); color:var(--danger-text); }
        .cbtn-confirm:hover { background:var(--danger-hover); }

        /* â”€â”€ MOBILE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @media(max-width:600px) {
            header { padding:12px 108px 8px; }
            header h1 { font-size:1.4em; letter-spacing:0.28em; }
            .bubble-wrap { max-width:88%; }
            .shortcut-hint { display:none; }
            .util-right { display:none; }
        }
    </style>
</head>
<body>

<!-- Fullscreen exit button (only visible in fullscreen mode) -->
<div class="fullscreen-exit">
    <button class="hbtn" onclick="toggleFullscreen()">âœ• EXIT FULLSCREEN</button>
</div>

<header>
    <div class="header-left">
        <button class="hbtn danger" onclick="confirmClear()">ğŸ—‘ CLEAR</button>
        <div class="size-btns">
            <button class="size-btn" onclick="changeSize(-1)" title="Smaller text">âˆ’</button>
            <button class="size-btn" onclick="changeSize(1)"  title="Larger text">+</button>
        </div>
    </div>
    <div class="header-controls">
        <button class="hbtn" onclick="toggleFullscreen()">â›¶ EXPAND</button>
        <button class="hbtn" onclick="toggleTheme()">
            <span id="themeIcon">â˜€ï¸</span>
            <span id="themeLabel">LIGHT</span>
        </button>
    </div>
    <h1>ğŸ‘‘ WIKKKAN ğŸ‘‘</h1>
    <p class="tagline">SOVEREIGN AI Â· CC0 PUBLICKÃ DOMÃNIA Â· ALL LOVE RESERVED</p>
    <nav>
        <a href="https://kkk.education">â† HOME</a>
        <a href="https://kkk.education/library.html">ğŸ“š LIBRARY</a>
        <a href="https://kkk.education/cinema.html">ğŸ¬ CINEMA</a>
    </nav>
</header>

<main>
    <div id="messages"></div>
    <div class="input-area">
        <div class="input-meta">
            <label class="web-toggle" id="webToggleLabel">
                <input type="checkbox" id="webToggle" onchange="updateWebToggle()"> ğŸŒ Search the web
            </label>
            <span class="char-count" id="charCount"></span>
        </div>
        <div class="input-row">
            <textarea id="msgInput"
                placeholder="Discuss anything..."
                rows="1"
                onkeydown="handleKey(event)"
                oninput="onInput(this)"></textarea>
            <button id="discussBtn" onclick="send()">DISCUSS ğŸ’¬</button>
        </div>
        <p class="shortcut-hint">Enter to send &nbsp;Â·&nbsp; Shift+Enter for new line</p>
    </div>
</main>

<footer>
    <div class="save-strip">
        <p>ğŸ’¾ SAVE TO USE WIKKKAN ANYWHERE â€” NO INTERNET NEEDED FOR THE INTERFACE</p>
        <button class="save-btn" onclick="savePage()">â¬‡ï¸ DOWNLOAD WIKKKAN.HTML</button>
        <button class="save-btn apk" onclick="window.open('https://kkk.education/wikkkan.apk','_blank')">ğŸ¤– DOWNLOAD ANDROID APK</button>
        <button class="save-btn" onclick="window.open('https://kkk.education/wikkkan.html','_blank')">ğŸŒ OPEN LIVE VERSION</button>
        <span id="saveStatus"></span>
    </div>
    <div class="util-strip">
        <span class="msg-counter" id="msgCounter"></span>
        <span style="font-family:'Cinzel',serif;font-size:0.58em;font-weight:700;color:var(--text-hint);letter-spacing:0.05em;">
            CONVERSATION SAVED Â· SURVIVES REFRESH
        </span>
    </div>
</footer>

<div id="toast"></div>

<div id="confirmOverlay">
    <div class="confirm-box">
        <p>CLEAR CONVERSATION?</p>
        <small>This will permanently erase all messages.</small>
        <div class="confirm-btns">
            <button class="cbtn-cancel" onclick="closeConfirm()">CANCEL</button>
            <button class="cbtn-confirm" onclick="doClear()">CLEAR ALL</button>
        </div>
    </div>
</div>

<script>
    var API       = 'https://wikkkan.kkk.education/wikkkan';
    var STORE_KEY = 'wikkkan_convo_v2';
    var THEME_KEY = 'wikkkan_theme';
    var SIZE_KEY  = 'wikkkan_size';
    var msgs      = document.getElementById('messages');
    var inp       = document.getElementById('msgInput');
    var btn       = document.getElementById('discussBtn');
    var root      = document.documentElement;
    var conversation = [];

    // â”€â”€ FONT SIZE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var SIZE_STEPS = [0.72, 0.78, 0.84, 0.88, 0.94, 1.0, 1.08, 1.16, 1.26];
    var sizeIdx = 3; // default = 0.88em

    function applySize() {
        root.style.setProperty('--chat-size', SIZE_STEPS[sizeIdx] + 'em');
    }

    function changeSize(dir) {
        sizeIdx = Math.max(0, Math.min(SIZE_STEPS.length - 1, sizeIdx + dir));
        applySize();
        localStorage.setItem(SIZE_KEY, sizeIdx);
        toast((dir > 0 ? 'ğŸ” Larger' : 'ğŸ” Smaller') + ' â€” ' + Math.round(SIZE_STEPS[sizeIdx] * 100) + '%');
    }

    (function() {
        var s = parseInt(localStorage.getItem(SIZE_KEY));
        if (!isNaN(s) && s >= 0 && s < SIZE_STEPS.length) sizeIdx = s;
        applySize();
    })();

    // â”€â”€ FULLSCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toggleFullscreen() {
        document.body.classList.toggle('fullscreen');
        msgs.scrollTop = msgs.scrollHeight;
    }

    // â”€â”€ THEME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toggleTheme() {
        var next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        document.getElementById('themeIcon').textContent  = next === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        document.getElementById('themeLabel').textContent = next === 'dark' ? 'LIGHT' : 'DARK';
        localStorage.setItem(THEME_KEY, next);
    }

    (function() {
        var s = localStorage.getItem(THEME_KEY);
        if (s && s !== 'dark') {
            root.setAttribute('data-theme', s);
            document.getElementById('themeIcon').textContent  = 'ğŸŒ™';
            document.getElementById('themeLabel').textContent = 'DARK';
        }
    })();

    // â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var toastTimer;
    function toast(msg, dur) {
        var el = document.getElementById('toast');
        el.textContent = msg;
        el.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(function() { el.classList.remove('show'); }, dur || 2000);
    }

    // â”€â”€ CONFIRM CLEAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function confirmClear() {
        if (conversation.length <= 1) { doClear(); return; }
        document.getElementById('confirmOverlay').classList.add('show');
    }

    function closeConfirm() { document.getElementById('confirmOverlay').classList.remove('show'); }

    function doClear() {
        closeConfirm();
        conversation = []; msgs.innerHTML = '';
        saveConversation(); showIntro(); updateCounter();
        toast('âœ¨ Conversation cleared');
    }

    document.getElementById('confirmOverlay').addEventListener('click', function(e) {
        if (e.target === this) closeConfirm();
    });

    // â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function safe(t) {
        return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
                .replace(/\n\n+/g,'<p style="margin-top:0.8em;display:block;">')
                .replace(/\n/g,'<br>');
    }

    function copyText(t) {
        navigator.clipboard.writeText(t).catch(function() {
            var a = document.createElement('textarea');
            a.value = t; document.body.appendChild(a); a.select();
            document.execCommand('copy'); document.body.removeChild(a);
        });
    }

    function updateCounter() {
        var n = conversation.length;
        document.getElementById('msgCounter').textContent =
            n > 0 ? n + ' message' + (n !== 1 ? 's' : '') : '';
    }

    function formatTime(iso) {
        return new Date(iso || Date.now()).toLocaleTimeString([], { hour:'2-digit', minute:'2-digit' });
    }

    function formatDate(iso) {
        var d = new Date(iso || Date.now());
        var today = new Date(), yest = new Date(today);
        yest.setDate(today.getDate() - 1);
        if (d.toDateString() === today.toDateString()) return 'TODAY';
        if (d.toDateString() === yest.toDateString())  return 'YESTERDAY';
        return d.toLocaleDateString([], { weekday:'long', month:'long', day:'numeric' }).toUpperCase();
    }

    function onInput(el) {
        el.style.height = 'auto';
        el.style.height = Math.min(el.scrollHeight, 150) + 'px';
        var n = el.value.length;
        var cc = document.getElementById('charCount');
        if (n > 80) {
            cc.textContent = n + ' chars';
            cc.className = 'char-count' + (n > 800 ? ' warn' : '');
        } else { cc.textContent = ''; cc.className = 'char-count'; }
    }

    function handleKey(e) {
        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); }
    }

    function updateWebToggle() {
        var label = document.getElementById('webToggleLabel');
        document.getElementById('webToggle').checked
            ? label.classList.add('active')
            : label.classList.remove('active');
    }

    // â”€â”€ PERSISTENCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function saveConversation() {
        try { localStorage.setItem(STORE_KEY, JSON.stringify(conversation)); }
        catch(e) {
            conversation = conversation.slice(Math.floor(conversation.length / 2));
            try { localStorage.setItem(STORE_KEY, JSON.stringify(conversation)); } catch(e2) {}
        }
    }

    function loadConversation() {
        try { var r = localStorage.getItem(STORE_KEY); return r ? JSON.parse(r) : null; }
        catch(e) { return null; }
    }

    // â”€â”€ DAY DIVIDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function needsDivider(prevTime, currTime) {
        if (!prevTime) return true;
        return new Date(prevTime).toDateString() !== new Date(currTime).toDateString();
    }

    function renderDivider(isoTime) {
        var d = document.createElement('div');
        d.className = 'day-divider';
        var s = document.createElement('span');
        s.textContent = formatDate(isoTime);
        d.appendChild(s); msgs.appendChild(d);
    }

    // â”€â”€ IS TOUCH DEVICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function isTouchDevice() {
        return window.matchMedia('(hover:none),(pointer:coarse)').matches;
    }

    // â”€â”€ RENDER MESSAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderMessage(item, skipAnim) {
        var div = document.createElement('div');
        div.className = 'msg ' + item.role;
        if (skipAnim) div.style.animation = 'none';

        var av = document.createElement('div');
        av.className = 'avatar';
        av.textContent = item.role === 'wikkkan' ? 'ğŸ‘‘' : 'ğŸŒŠ';

        var wrap = document.createElement('div');
        wrap.className = 'bubble-wrap';

        var bub = document.createElement('div');
        bub.className = 'bubble';
        bub.innerHTML = item.html;

        wrap.appendChild(bub);

        if (item.role === 'wikkkan') {
            var cb = document.createElement('button');
            cb.className = 'copy-btn';
            cb.textContent = 'COPY';
            cb.onclick = (function(b, c) { return function() {
                var clone = b.cloneNode(true);
                var btn2 = clone.querySelector('.copy-btn');
                if (btn2) btn2.remove();
                copyText(clone.innerText);
                c.textContent = 'âœ“';
                toast('âœ“ Copied');
                setTimeout(function() { c.textContent = 'COPY'; }, 1800);
            }; })(bub, cb);

            if (isTouchDevice()) {
                // On touch: place copy button BELOW the bubble in wrap
                wrap.appendChild(cb);
            } else {
                // On desktop: place inside bubble (absolute positioned via CSS)
                bub.appendChild(cb);
            }
        }

        var tEl = document.createElement('div');
        tEl.className = 'msg-time';
        tEl.textContent = formatTime(item.time);
        wrap.appendChild(tEl);

        if (item.books && item.books.length) {
            var s = document.createElement('div');
            s.className = 'sources';
            s.textContent = 'ğŸ“š ' + item.books.join(' Â· ');
            wrap.appendChild(s);
        }

        if (item.urls && item.urls.length) {
            var links = item.urls.map(function(u) {
                try { return '<a href="'+u+'" target="_blank" rel="noopener">'+new URL(u).hostname.replace('www.','')+' â†—</a>'; }
                catch(e) { return ''; }
            }).filter(Boolean);
            if (links.length) {
                var ws = document.createElement('div');
                ws.className = 'sources';
                ws.innerHTML = 'ğŸŒ ' + links.join(' Â· ');
                wrap.appendChild(ws);
            }
        }

        div.appendChild(av); div.appendChild(wrap);
        msgs.appendChild(div);
        return div;
    }

    // â”€â”€ THINKING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showThinking(web) {
        var d = document.createElement('div');
        d.className = 'msg wikkkan'; d.id = 'thinking';
        var av = document.createElement('div'); av.className = 'avatar'; av.textContent = 'ğŸ‘‘';
        var w = document.createElement('div'); w.className = 'bubble-wrap';
        var b = document.createElement('div'); b.className = 'bubble';
        b.innerHTML = '<div class="dots"><span></span><span></span><span></span></div>';
        var lbl = document.createElement('div');
        lbl.className = 'thinking-label';
        lbl.textContent = web ? 'Searching books & web...' : 'Searching books...';
        b.appendChild(lbl); w.appendChild(b); d.appendChild(av); d.appendChild(w);
        msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight;
    }

    function hideThinking() { var t = document.getElementById('thinking'); if (t) t.remove(); }

    // â”€â”€ SEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function send() {
        var q = inp.value.trim();
        if (!q) return;

        var url    = (q.match(/https?:\/\/[^\s]+/) || [''])[0];
        var useWeb = document.getElementById('webToggle').checked;
        var now    = new Date().toISOString();

        var last = conversation[conversation.length - 1];
        if (needsDivider(last ? last.time : null, now)) renderDivider(now);

        var userItem = { role:'user', html:safe(q), time:now };
        conversation.push(userItem);
        renderMessage(userItem, false);
        saveConversation(); updateCounter();

        inp.value = ''; inp.style.height = 'auto';
        document.getElementById('charCount').textContent = '';
        btn.disabled = true; showThinking(useWeb);

        try {
            var res = await fetch(API, {
                method:'POST', headers:{'Content-Type':'application/json'},
                body:JSON.stringify({ question:q, web:useWeb, url:url })
            });

            if (!res.ok) throw new Error('HTTP ' + res.status);
            hideThinking();

            var wNow = new Date().toISOString();
            var wDiv = document.createElement('div'); wDiv.className = 'msg wikkkan';
            var wAv = document.createElement('div'); wAv.className = 'avatar'; wAv.textContent = 'ğŸ‘‘';
            var wWrap = document.createElement('div'); wWrap.className = 'bubble-wrap';
            var wBub = document.createElement('div'); wBub.className = 'bubble';

            var textSpan = document.createElement('span');
            wBub.appendChild(textSpan);

            var cur = document.createElement('span'); cur.className = 'cursor';
            wBub.appendChild(cur);

            var wCb = document.createElement('button'); wCb.className = 'copy-btn'; wCb.textContent = 'COPY';

            wWrap.appendChild(wBub);

            // Place copy button based on device type
            if (isTouchDevice()) {
                wWrap.appendChild(wCb);
            } else {
                wBub.appendChild(wCb);
            }

            var wTime = document.createElement('div'); wTime.className = 'msg-time'; wTime.textContent = formatTime(wNow);
            wWrap.appendChild(wTime);
            wDiv.appendChild(wAv); wDiv.appendChild(wWrap);
            msgs.appendChild(wDiv);

            var books = [], urls = [], full = '';
            var reader = res.body.getReader();
            var dec = new TextDecoder(), buf = '';

            while (true) {
                var r = await reader.read();
                if (r.done) break;
                buf += dec.decode(r.value, {stream:true});
                var lines = buf.split('\n'); buf = lines.pop();

                for (var line of lines) {
                    if (!line.startsWith('data: ')) continue;
                    try {
                        var d = JSON.parse(line.slice(6));
                        if (d.sources !== undefined) {
                            books = d.sources; urls = d.web_urls || [];
                        } else if (d.token) {
                            full += d.token;
                            textSpan.innerHTML = safe(full);
                            msgs.scrollTop = msgs.scrollHeight;
                        } else if (d.done) {
                            if (cur.parentNode) cur.remove();

                            wCb.onclick = (function(b, c) { return function() {
                                var clone = b.cloneNode(true);
                                var btn2 = clone.querySelector('.copy-btn');
                                if (btn2) btn2.remove();
                                copyText(clone.innerText);
                                c.textContent = 'âœ“';
                                toast('âœ“ Copied');
                                setTimeout(function() { c.textContent = 'COPY'; }, 1800);
                            }; })(wBub, wCb);

                            if (books.length) {
                                var sEl = document.createElement('div'); sEl.className = 'sources';
                                sEl.textContent = 'ğŸ“š ' + books.join(' Â· ');
                                wWrap.appendChild(sEl);
                            }

                            if (urls.length) {
                                var wLinks = urls.map(function(u) {
                                    try { return '<a href="'+u+'" target="_blank" rel="noopener">'+new URL(u).hostname.replace('www.','')+' â†—</a>'; }
                                    catch(e) { return ''; }
                                }).filter(Boolean);
                                if (wLinks.length) {
                                    var wSrc = document.createElement('div'); wSrc.className = 'sources';
                                    wSrc.innerHTML = 'ğŸŒ ' + wLinks.join(' Â· ');
                                    wWrap.appendChild(wSrc);
                                }
                            }

                            var wItem = { role:'wikkkan', html:safe(full), books:books, urls:urls, time:wNow };
                            conversation.push(wItem);
                            saveConversation(); updateCounter();
                        }
                    } catch(e) {}
                }
            }

            if (cur.parentNode) cur.remove();

        } catch(e) {
            hideThinking();
            var errHtml = 'âŒ Could not reach WIKKKAN server.<br><small style="opacity:0.6">'+safe(e.message)+'</small>';
            var errItem = { role:'wikkkan', html:errHtml, time:new Date().toISOString() };
            conversation.push(errItem); renderMessage(errItem, false);
            saveConversation(); updateCounter();
        }

        btn.disabled = false; inp.focus();
    }

    // â”€â”€ SAVE PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function savePage() {
        var s = document.getElementById('saveStatus');
        s.textContent = 'â³ Downloading...';
        try {
            var r = await fetch('https://kkk.education/wikkkan.html');
            var t = await r.text();
            var a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([t],{type:'text/html'}));
            a.download = 'wikkkan.html';
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
            s.textContent = 'âœ… Saved!';
            toast('âœ… wikkkan.html downloaded!', 3000);
            setTimeout(function() { s.textContent = ''; }, 4000);
        } catch(e) {
            s.textContent = 'âŒ Failed';
            toast('âŒ Could not save: ' + e.message, 3500);
        }
    }

    // â”€â”€ INTRO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showIntro() {
        var now  = new Date().toISOString();
        var html =
            'I am WIKKKAN â€” the digital twin of Wendell Charles NeSmith.<br><br>' +
            'I carry 36 years of creation: philosophy, poetry, sovereignty, love â€” all of it. ' +
            'Discuss anything, share something you want to explore, or paste a URL and I will read it for you.<br><br>' +
            '<strong style="color:var(--gold-dim)">âš  Each message is a fresh prompt.</strong> ' +
            'I do not remember what was said earlier in this conversation. ' +
            'If you want me to continue a thread, include the context â€” paste the relevant part or say who or what you mean. ' +
            'For example: say <em>"Wendy"</em> not <em>"she"</em> â€” I cannot assume.<br><br>' +
            'Your conversation is saved in your browser and survives refresh. ' +
            'Use the buttons below to download me for offline use or as an Android app.<br><br>' +
            '<em style="color:var(--gold-dim)">AMORIARIACKA</em>';
        var item = { role:'wikkkan', html:html, time:now };
        conversation.push(item); renderMessage(item, true);
        saveConversation(); updateCounter();
    }

    // â”€â”€ RESTORE OR INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    window.addEventListener('load', function() {
        var saved = loadConversation();
        if (saved && saved.length > 0) {
            conversation = saved;
            var lastDate = null;
            for (var i = 0; i < saved.length; i++) {
                var item = saved[i];
                if (needsDivider(lastDate, item.time)) renderDivider(item.time);
                renderMessage(item, true);
                lastDate = item.time;
            }
            msgs.scrollTop = msgs.scrollHeight;
            updateCounter();
            toast('âœ¨ ' + saved.length + ' messages restored');
        } else {
            showIntro();
        }
        inp.focus();
    });
</script>
</body>
</html>